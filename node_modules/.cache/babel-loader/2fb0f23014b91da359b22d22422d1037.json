{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useReducer, useEffect, useState } from \"react\";\nimport { projectFirestore, timestamp } from \"../firebase/config\";\nlet initialState = {\n  document: null,\n  isPending: false,\n  error: null,\n  success: null\n};\nconst firestoreReducer = (state, action) => {\n  switch (action.type) {\n    case \"IS_PENDING\":\n      return {\n        isPending: true,\n        document: null,\n        success: false,\n        error: null\n      };\n    case \"ADDED_DOCUMENT\":\n      return {\n        isPending: false,\n        document: action.payload,\n        success: true,\n        error: null\n      };\n    case \"ERROR\":\n      return {\n        isPending: false,\n        document: null,\n        success: false,\n        error: action.payload\n      };\n    default:\n      return state;\n  }\n};\nexport const useFirestore = collection => {\n  _s();\n  const [resposne, dispatch] = useReducer(firestoreReducer, initialState);\n  const [isCancelled, setIsCancelled] = useState(false);\n\n  //collections\n  const ref = projectFirestore.collection(collection);\n\n  //only dispatch is not cancelled\n  const dispatchIfNotCancelled = action => {\n    if (!isCancelled) {\n      dispatch(action);\n    }\n  };\n\n  // add a document\n  const addDocument = async doc => {\n    dispatch({\n      type: \"IS_PENDING\"\n    });\n    try {\n      const createdAt = timestamp.fromDate(new Date());\n      const addedDocument = await ref.add({\n        ...doc,\n        createdAt\n      });\n      dispatchIfNotCancelled({\n        type: \"ADDED_DOCUMENT\",\n        payload: addedDocument\n      });\n    } catch (err) {\n      dispatchIfNotCancelled({\n        type: \"ERROR\",\n        payload: err.message\n      });\n    }\n  };\n\n  //delete\n  const deleteDocument = async id => {};\n  useEffect(() => {\n    return () => setIsCancelled(true);\n  }, []);\n  return {\n    addDocument,\n    deleteDocument,\n    resposne\n  };\n};\n_s(useFirestore, \"VBAsZuIO2y1ahrD8VyFGvV2Hqhw=\");","map":{"version":3,"names":["useReducer","useEffect","useState","projectFirestore","timestamp","initialState","document","isPending","error","success","firestoreReducer","state","action","type","payload","useFirestore","collection","_s","resposne","dispatch","isCancelled","setIsCancelled","ref","dispatchIfNotCancelled","addDocument","doc","createdAt","fromDate","Date","addedDocument","add","err","message","deleteDocument","id"],"sources":["/Users/zhaoruzhu/Downloads/StartupSystem/milestone-3/milestone-3-zz795/src/hooks/useFirestore.js"],"sourcesContent":["import { useReducer, useEffect, useState } from \"react\";\nimport { projectFirestore, timestamp } from \"../firebase/config\";\n\nlet initialState = {\n  document: null,\n  isPending: false,\n  error: null,\n  success: null,\n};\n\nconst firestoreReducer = (state, action) => {\n  switch (action.type) {\n    case \"IS_PENDING\":\n      return { isPending: true, document: null, success: false, error: null };\n    case \"ADDED_DOCUMENT\":\n      return {\n        isPending: false,\n        document: action.payload,\n        success: true,\n        error: null,\n      };\n    case \"ERROR\":\n      return {\n        isPending: false,\n        document: null,\n        success: false,\n        error: action.payload,\n      };\n    default:\n      return state;\n  }\n};\n\nexport const useFirestore = (collection) => {\n  const [resposne, dispatch] = useReducer(firestoreReducer, initialState);\n  const [isCancelled, setIsCancelled] = useState(false);\n\n  //collections\n  const ref = projectFirestore.collection(collection);\n\n  //only dispatch is not cancelled\n  const dispatchIfNotCancelled = (action) => {\n    if (!isCancelled) {\n      dispatch(action);\n    }\n  };\n\n  // add a document\n  const addDocument = async (doc) => {\n    dispatch({ type: \"IS_PENDING\" });\n\n    try {\n      const createdAt = timestamp.fromDate(new Date());\n      const addedDocument = await ref.add({ ...doc, createdAt });\n      dispatchIfNotCancelled({\n        type: \"ADDED_DOCUMENT\",\n        payload: addedDocument,\n      });\n    } catch (err) {\n      dispatchIfNotCancelled({ type: \"ERROR\", payload: err.message });\n    }\n  };\n\n  //delete\n  const deleteDocument = async (id) => {};\n\n  useEffect(() => {\n    return () => setIsCancelled(true);\n  }, []);\n\n  return { addDocument, deleteDocument, resposne };\n};\n"],"mappings":";AAAA,SAASA,UAAU,EAAEC,SAAS,EAAEC,QAAQ,QAAQ,OAAO;AACvD,SAASC,gBAAgB,EAAEC,SAAS,QAAQ,oBAAoB;AAEhE,IAAIC,YAAY,GAAG;EACjBC,QAAQ,EAAE,IAAI;EACdC,SAAS,EAAE,KAAK;EAChBC,KAAK,EAAE,IAAI;EACXC,OAAO,EAAE;AACX,CAAC;AAED,MAAMC,gBAAgB,GAAGA,CAACC,KAAK,EAAEC,MAAM,KAAK;EAC1C,QAAQA,MAAM,CAACC,IAAI;IACjB,KAAK,YAAY;MACf,OAAO;QAAEN,SAAS,EAAE,IAAI;QAAED,QAAQ,EAAE,IAAI;QAAEG,OAAO,EAAE,KAAK;QAAED,KAAK,EAAE;MAAK,CAAC;IACzE,KAAK,gBAAgB;MACnB,OAAO;QACLD,SAAS,EAAE,KAAK;QAChBD,QAAQ,EAAEM,MAAM,CAACE,OAAO;QACxBL,OAAO,EAAE,IAAI;QACbD,KAAK,EAAE;MACT,CAAC;IACH,KAAK,OAAO;MACV,OAAO;QACLD,SAAS,EAAE,KAAK;QAChBD,QAAQ,EAAE,IAAI;QACdG,OAAO,EAAE,KAAK;QACdD,KAAK,EAAEI,MAAM,CAACE;MAChB,CAAC;IACH;MACE,OAAOH,KAAK;EAChB;AACF,CAAC;AAED,OAAO,MAAMI,YAAY,GAAIC,UAAU,IAAK;EAAAC,EAAA;EAC1C,MAAM,CAACC,QAAQ,EAAEC,QAAQ,CAAC,GAAGnB,UAAU,CAACU,gBAAgB,EAAEL,YAAY,CAAC;EACvE,MAAM,CAACe,WAAW,EAAEC,cAAc,CAAC,GAAGnB,QAAQ,CAAC,KAAK,CAAC;;EAErD;EACA,MAAMoB,GAAG,GAAGnB,gBAAgB,CAACa,UAAU,CAACA,UAAU,CAAC;;EAEnD;EACA,MAAMO,sBAAsB,GAAIX,MAAM,IAAK;IACzC,IAAI,CAACQ,WAAW,EAAE;MAChBD,QAAQ,CAACP,MAAM,CAAC;IAClB;EACF,CAAC;;EAED;EACA,MAAMY,WAAW,GAAG,MAAOC,GAAG,IAAK;IACjCN,QAAQ,CAAC;MAAEN,IAAI,EAAE;IAAa,CAAC,CAAC;IAEhC,IAAI;MACF,MAAMa,SAAS,GAAGtB,SAAS,CAACuB,QAAQ,CAAC,IAAIC,IAAI,CAAC,CAAC,CAAC;MAChD,MAAMC,aAAa,GAAG,MAAMP,GAAG,CAACQ,GAAG,CAAC;QAAE,GAAGL,GAAG;QAAEC;MAAU,CAAC,CAAC;MAC1DH,sBAAsB,CAAC;QACrBV,IAAI,EAAE,gBAAgB;QACtBC,OAAO,EAAEe;MACX,CAAC,CAAC;IACJ,CAAC,CAAC,OAAOE,GAAG,EAAE;MACZR,sBAAsB,CAAC;QAAEV,IAAI,EAAE,OAAO;QAAEC,OAAO,EAAEiB,GAAG,CAACC;MAAQ,CAAC,CAAC;IACjE;EACF,CAAC;;EAED;EACA,MAAMC,cAAc,GAAG,MAAOC,EAAE,IAAK,CAAC,CAAC;EAEvCjC,SAAS,CAAC,MAAM;IACd,OAAO,MAAMoB,cAAc,CAAC,IAAI,CAAC;EACnC,CAAC,EAAE,EAAE,CAAC;EAEN,OAAO;IAAEG,WAAW;IAAES,cAAc;IAAEf;EAAS,CAAC;AAClD,CAAC;AAACD,EAAA,CAtCWF,YAAY","ignoreList":[]},"metadata":{},"sourceType":"module"}